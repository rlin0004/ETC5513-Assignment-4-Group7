---
title: "ETC5513 Assignment4 Group7"
author:
- familyname: xxxxx
  othernames: xxxxx
  address: Monash University
  correspondingauthor: true
- familyname: xxx
  othernames: xxx
  address: Monash University
- familyname: xxx
  othernames: xxx
  address: Monash University
department: Department of\newline Econometrics &\newline Business Statistics
organization: Acme Corporation
bibliography: references.bib
biblio-style: authoryear-comp
linestretch: 1.5
output:
  MonashEBSTemplates::report:
    fig_caption: yes
    fig_height: 5
    fig_width: 8
    includes:
      in_header: preamble.tex
    keep_tex: yes
    number_sections: yes
    citation_package: biblatex
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=TRUE, messages=FALSE, warning=FALSE)
# Make sure you have the latest versions of rmarkdown and bookdown installed
library(ggplot2)
```


# Introduction

# Analysis

\section*{body 1}

\section*{body 2}

\section*{body 3}

\section*{Police Proceedings}

# Conclusion

# Reference


```{r library}
library(tidyverse)
library(readxl)
library(dplyr)
library(readr)
```

```{r import_data4}
NSW <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 2, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
NSW$`2008–09` =as.double(NSW$`2008–09`)
NSW <- NSW[-16,]
NSW <- NSW %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
NSW$States <- "NSW"

NSW <- NSW %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))

VIC <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 3, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
VIC$`2008–09` =as.double(VIC$`2008–09`)
VIC <- VIC[-16,]
VIC <- VIC %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
VIC$States <- "VIC"

VIC <- VIC %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))

QLD <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 4, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
QLD$`2008–09` =as.double(QLD$`2008–09`)
QLD <- QLD[-16,]
QLD <- QLD %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
QLD$States <- "QLD"

QLD <- QLD %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))

SA <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 5, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
SA$`2008–09` =as.double(SA$`2008–09`)
SA <- SA[-16,]
SA <- SA %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
SA$States <- "SA"

SA <- SA %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))


TAS <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 6, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
TAS$`2008–09` =as.double(TAS$`2008–09`)
TAS <- TAS[-16,]
TAS <- TAS %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
TAS$States <- "TAS"

TAS <- TAS %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))


ACT <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 8, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`))
ACT$`2008–09` =as.double(ACT$`2008–09`)
ACT <- ACT[-16,]
ACT <- ACT %>% mutate(Action = c(rep("Court",15),rep("Non_Court",15)))
ACT$States <- "ACT"

ACT <- ACT %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "Cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))


procced <- bind_rows(NSW, VIC, QLD, SA, TAS, ACT)
```

```{r zyliu1}
procced %>%
  group_by(Action) %>%
  ggplot(aes(Year, Cases,
             colour = States,
             fill = States)) +
  geom_col() +
  facet_wrap(~States)

```




```{r}
NSW2 <- read_excel(here::here("data/5. police proceedings, selected states and territories.xls"), 
                      sheet = 2, range = "A6:L39") %>% 
  dplyr::filter(!is.na(`Principal offence`)) 
NSW2$`2008–09` =as.double(NSW2$`2008–09`)
NSW2 <- NSW2[-16,]
NSW2 <- NSW2 %>% mutate(procceding = c(rep("ture",15),rep("FALSE",15)))

NSW2 <- NSW2 %>%  pivot_longer(cols = `2008–09`:`2018–19`,
               names_to = "Year", 
               values_to = "cases") %>%
   mutate(Year = year(as.Date(Year, "%Y")))
```


